import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
import matplotlib.pyplot as plt
from keras import optimizers, losses, metrics, regularizers



# Función para cargar datos desde un archivo txt y normalizar
def cargar_datos_desde_txt(file_path):
    vectors = []

    with open(file_path, 'r') as file:
        lines = file.readlines()

        # Leer datos de vectores
        for line in lines:
            if line.strip():  # asegurarse de que la línea no esté vacía
                vector = [int(num) for num in line.strip().split(',')]
                vectors.append(vector)

    # Convertir a numpy.ndarray y normalizar dividiendo por 255
    return np.array(vectors, dtype=np.float32) / 255.0

def cargar_datos_1_desde_txt(labels_path):
    labels = []

    with open(labels_path, 'r') as file:
        lines = file.readlines()

        # Leer datos de vectores
        for line in lines:
            if line.strip():  # asegurarse de que la línea no esté vacía
                label = [int(num) for num in line.strip().split(',')]
                labels.append(label)

    # Convertir a numpy.ndarray y normalizar dividiendo por 255
    return np.array(labels, dtype=np.float32)

# Ruta al archivo de texto que contiene los datos
data_path = 'vectors30.txt'
labels_path = 'labels30_int.txt'
# Cargar datos desde el archivo y normalizar
data = cargar_datos_desde_txt(data_path)


# Verificar la cantidad de muestras en los datos
print(f"Número de muestras en data: {len(data)}")

# Generar etiquetas del 0 al 19 (para 20 vectores de entrada)
labels = cargar_datos_1_desde_txt(labels_path)  # Esto crea un arreglo de numpy [0, 1, ..., 19]

# Crear el modelo de red neuronal
model = Sequential()
model.add(Dense(80, input_dim=900, activation='relu'))  # Capa Oculta 1, activación ReLU      
model.add(Dense(60, activation='relu'))                # Capa Oculta 3, activación ReLU
model.add(Dense(30, activation='relu'))                # Capa Oculta 3, activación ReLU
model.add(Dense(7, activation='softmax'))             # Capa de Salida, activación Softmax para clasificación multiclase (6 clases)

#model.compile(loss='sparse_categorical_crossentropy',
#              optimizer='adam',
#              metrics=['accuracy'])
#
model.compile(
    loss=losses.sparse_categorical_crossentropy,  # Función de pérdida
    optimizer=optimizers.Adam(learning_rate=0.0001),  # Optimizador Adam con tasa de aprendizaje especificada
    metrics=[metrics.SparseCategoricalAccuracy(), 'accuracy'],  # Métricas para evaluar el modelo
)

# Entrenar el modelo con las etiquetas y los datos normalizados
history = model.fit(data, labels, epochs=10, batch_size=1, verbose=1)


# Gráficos de precisión y pérdida
plt.figure(figsize=(8, 4))

# Gráfico de Precisión
plt.subplot(1, 2, 1)
plt.plot(history.history['accuracy'])
plt.title('Model Accuracy')
plt.xlabel('Epoch')
plt.ylabel('Accuracy')
plt.grid(True)
# Gráfico de Pérdida
plt.subplot(1, 2, 2)
plt.plot(history.history['loss'])
plt.title('Model Loss')
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.grid(True)
plt.tight_layout()

# Definir los vectores v1, v2, v3, v4
va1 = np.array([172,174,175,174,175,173,171,172,171,176,168,168,166,170,170,173,174,176,177,181,186,192,189,188,189,189,188,182,175,173,183,184,184,183,186,185,184,186,186,184,184,186,186,191,191,189,189,191,191,191,193,194,194,194,194,194,189,189,189,189,183,184,184,184,184,184,184,184,184,184,184,184,184,188,189,191,191,191,191,191,193,194,194,194,193,193,191,189,187,189,183,183,184,184,183,184,184,186,186,186,186,188,187,189,192,191,191,193,193,191,193,194,194,194,194,190,191,191,189,190,182,183,183,183,184,184,184,186,186,186,186,188,189,191,191,179,193,190,193,192,193,194,194,194,194,192,191,191,190,192,183,183,183,183,184,184,184,186,186,188,188,188,188,189,188,95,95,192,193,191,192,193,193,194,194,193,191,191,191,191,183,183,183,183,184,184,186,186,188,188,188,188,188,185,98,93,95,197,193,193,193,194,194,194,194,193,191,191,192,194,183,183,181,183,183,184,186,186,188,188,186,189,189,147,95,92,95,194,194,196,193,196,194,194,194,193,193,193,194,199,180,183,183,183,184,184,186,186,188,189,189,189,188,95,89,147,95,195,196,196,196,196,197,196,195,193,194,193,194,197,185,183,184,184,184,185,186,186,188,188,188,189,97,95,164,190,95,145,196,196,196,197,197,198,194,193,194,194,194,198,188,185,184,184,186,187,188,189,188,188,188,106,92,96,194,193,94,98,195,199,196,197,197,197,194,193,193,193,194,202,186,186,184,184,186,186,188,189,189,189,185,92,93,193,194,193,93,98,197,197,198,199,198,198,194,193,193,193,192,196,186,186,186,186,186,187,189,189,189,189,94,89,191,193,194,194,91,97,196,196,198,199,197,198,194,193,191,193,192,197,186,184,184,186,186,186,186,189,187,92,90,97,190,193,194,194,167,93,156,196,198,199,199,197,196,194,193,191,192,195,184,184,184,186,186,186,188,188,184,91,84,193,191,193,194,194,198,95,90,193,199,197,199,197,195,194,193,193,192,195,184,184,184,186,186,186,186,185,87,86,167,188,191,193,193,194,194,97,94,194,195,197,197,198,195,193,193,193,194,192,186,184,184,186,186,186,186,177,84,83,190,189,190,195,191,192,197,99,88,184,196,197,197,197,197,196,194,193,191,196,184,186,184,186,186,186,187,83,83,127,78,79,82,86,86,86,86,80,82,90,197,197,197,196,196,196,194,194,194,191,184,184,184,184,184,186,172,69,70,76,78,81,84,85,143,182,193,193,89,87,192,196,196,196,196,194,194,193,191,189,183,183,184,184,184,184,81,75,83,205,185,191,191,193,192,193,193,193,191,83,86,194,196,196,196,194,194,193,191,187,183,183,183,184,184,184,81,83,185,189,189,191,193,193,194,194,194,194,193,88,85,194,194,194,194,194,194,193,191,183,181,183,181,183,181,73,81,92,186,188,189,191,191,193,193,194,194,194,194,193,82,87,193,193,194,193,191,191,189,177,181,181,181,181,181,75,77,185,186,187,189,189,191,193,193,193,194,194,193,193,107,82,128,193,193,193,191,191,188,177,180,181,181,181,111,70,77,184,184,186,188,188,189,191,193,194,194,194,194,193,193,85,85,196,191,191,191,189,188,179,180,181,180,180,67,71,132,183,183,184,186,186,188,188,189,191,193,193,193,193,193,189,84,85,184,189,189,188,186,179,180,180,180,163,66,63,181,183,183,185,186,186,186,188,188,189,191,193,193,193,193,191,166,84,88,186,189,188,186,184,179,180,179,175,64,64,181,181,181,182,184,184,184,185,188,189,190,190,190,191,192,191,186,109,80,189,188,187,186,188,178,178,178,178,178,178,178,180,180,180,180,181,181,183,184,183,186,189,189,188,189,189,189,189,189,188,186,186,184,189,175,176,176,176,176,176,178,178,180,180,180,178,180,180,183,183,184,184,186,185,186,188,189,188,188,188,186,184,184,184,175,175,176,174,177,177,175,174,175,174,176,174,174,178,177,179,181,182,182,181,182,183,184,184,186,186,184,181,187,183], dtype=np.float32) / 255.0
va2 = np.array([186,145,189,191,191,189,189,184,187,189,189,188,188,188,192,191,191,190,186,184,186,183,181,183,188,190,190,191,192,193,184,160,188,189,189,191,189,185,186,188,189,188,188,188,191,191,191,193,192,190,189,186,184,184,183,184,185,186,187,189,184,180,189,189,188,189,188,186,186,188,189,189,189,188,188,193,192,193,194,193,193,186,184,184,184,186,184,186,186,186,184,191,191,188,188,188,188,186,187,188,188,189,191,190,174,94,99,106,196,194,193,189,189,189,186,186,186,186,186,186,184,192,189,188,188,188,186,186,188,187,188,188,174,96,94,95,105,133,93,101,193,193,189,191,188,189,188,186,187,188,183,188,188,188,188,186,186,186,188,186,190,97,94,90,184,193,196,196,179,92,110,193,191,193,191,189,189,189,187,189,185,185,186,188,188,186,184,187,188,192,92,92,98,185,191,193,196,196,196,99,94,191,189,191,191,191,189,189,189,190,180,186,186,186,186,186,184,187,186,87,87,114,192,194,194,195,196,196,197,197,96,100,194,193,191,191,191,191,191,194,182,188,186,188,186,186,186,187,113,85,91,191,191,194,194,196,197,197,197,197,96,92,196,196,193,193,191,191,193,194,177,185,188,188,186,186,184,185,81,82,188,193,194,194,194,196,197,197,197,197,89,95,196,196,194,193,193,191,193,194,158,185,186,186,188,186,186,90,87,159,188,192,194,194,196,196,197,197,197,197,157,93,179,196,194,194,192,193,193,193,147,186,186,188,186,186,186,84,87,190,191,193,194,196,196,197,197,197,197,197,193,86,110,197,193,193,193,193,193,192,150,186,186,186,186,186,168,84,102,190,193,193,194,196,196,197,199,197,197,197,197,88,91,196,193,193,193,193,193,194,141,186,186,186,186,186,80,79,185,190,193,193,194,196,196,197,199,197,197,197,196,89,87,196,193,193,193,191,193,195,161,184,184,186,186,186,78,79,188,189,191,193,194,194,196,197,197,197,197,196,196,87,87,194,194,189,191,191,191,179,170,186,186,186,186,186,79,72,185,189,191,193,193,194,194,196,197,196,196,196,196,96,86,195,194,194,193,191,190,178,184,186,186,186,186,161,73,70,74,78,79,91,81,80,88,88,87,84,85,81,89,90,79,190,194,194,193,193,189,189,185,186,184,184,184,99,69,69,75,77,80,82,84,83,87,87,87,85,87,89,85,80,78,188,196,196,194,193,193,189,187,186,184,184,184,73,75,180,190,189,193,193,194,193,194,198,195,194,196,196,196,180,85,173,196,196,195,194,192,197,184,184,186,184,185,74,74,191,188,190,193,194,194,196,196,196,196,196,196,196,196,189,85,169,196,196,196,194,194,195,184,183,184,184,185,74,74,188,189,190,193,194,194,196,196,196,196,196,196,196,196,173,85,161,194,194,194,194,193,194,184,184,183,183,181,72,72,192,187,189,193,193,194,194,196,196,196,196,196,196,196,168,84,158,194,194,194,194,193,191,183,184,183,183,180,71,69,181,187,189,191,193,193,193,194,194,196,196,196,196,196,154,80,163,194,194,194,193,193,189,186,184,183,181,181,67,69,164,184,188,189,191,191,193,194,194,194,196,196,194,196,112,81,179,194,194,194,194,190,187,187,186,182,181,181,74,69,131,183,185,186,189,191,191,193,194,194,194,194,194,194,81,82,189,193,194,193,193,189,186,184,184,184,181,181,79,67,108,181,184,185,188,189,191,192,193,193,194,194,194,194,195,191,193,193,193,193,193,190,184,183,183,183,181,180,178,172,180,181,182,184,184,186,188,188,189,189,191,191,191,193,193,193,191,191,191,191,191,193,184,183,181,181,180,180,178,178,180,180,181,181,183,184,186,186,188,188,189,189,191,191,191,191,193,191,191,191,189,187,184,183,181,180,180,178,179,178,178,180,180,181,181,181,181,183,183,184,186,188,189,189,191,191,191,189,191,189,189,185,183,164,169,168,173,172,171,171,165,158,142,140,163,174,176,177,181,179,180,182,179,186,188,187,186,188,187,187,186,185,167], dtype=np.float32) / 255.0

ve1 = np.array([184,182,184,183,184,184,186,186,186,186,186,186,184,184,186,191,188,189,191,191,193,194,197,197,197,198,198,198,198,195,183,171,183,183,183,167,76,82,82,81,85,86,119,163,180,188,188,186,191,191,191,194,196,196,196,196,196,196,195,193,181,164,184,183,183,105,77,73,78,82,81,83,82,88,89,88,90,92,92,100,169,192,194,195,193,193,193,194,193,193,181,179,183,183,181,77,79,177,184,188,191,191,188,193,184,113,84,86,86,87,93,94,98,101,192,193,193,194,193,194,181,181,184,181,180,79,84,189,187,188,191,191,191,191,194,189,191,186,188,189,189,123,92,90,196,194,193,194,193,193,183,179,181,183,184,79,81,182,187,190,189,191,191,193,191,189,191,191,193,193,194,197,196,196,196,196,196,194,194,194,180,180,180,180,174,77,79,185,186,191,191,193,193,192,194,187,189,191,196,197,196,197,197,196,196,194,196,194,194,194,173,181,180,178,174,77,81,178,183,189,191,192,194,193,195,194,193,193,195,198,199,200,197,197,199,197,196,192,193,202,163,184,183,180,180,77,83,179,184,185,188,191,195,195,199,196,197,196,194,197,199,201,196,196,196,192,196,196,192,196,168,184,183,181,178,77,77,184,184,188,189,193,194,196,197,197,200,195,196,197,200,201,196,196,196,196,196,197,194,195,182,184,183,180,179,77,77,184,186,188,189,193,194,196,200,200,201,200,201,200,202,201,202,197,197,196,196,197,196,182,187,184,184,185,178,76,71,184,186,188,189,192,194,196,200,199,201,202,202,202,202,202,201,200,197,196,196,196,194,184,183,184,184,184,178,73,72,179,182,183,186,185,193,196,199,197,198,200,200,202,204,204,201,201,199,197,196,196,196,198,184,184,183,184,180,69,66,75,77,81,82,84,85,90,90,89,93,97,97,203,203,202,202,201,199,200,197,197,196,201,184,182,181,183,175,74,85,187,189,190,193,195,195,194,196,196,189,168,96,202,199,202,202,204,201,201,199,197,197,199,183,183,183,184,163,79,105,186,189,191,193,194,196,195,197,197,197,198,200,202,202,202,201,202,201,201,199,197,196,197,181,183,183,183,136,79,120,188,189,191,193,195,196,197,199,199,199,198,201,201,201,201,201,202,199,201,201,199,201,196,180,180,181,183,150,79,115,189,191,192,194,194,196,197,199,197,199,199,199,201,201,201,201,201,201,199,197,197,192,196,183,183,181,183,128,78,141,187,189,193,193,196,196,197,199,199,197,197,199,201,201,201,201,201,199,199,196,196,181,194,181,181,181,183,111,78,167,186,188,192,193,196,196,197,197,201,201,200,199,199,201,201,199,201,199,197,197,196,183,194,180,180,180,180,112,78,153,185,186,188,189,193,193,194,194,197,201,201,201,199,201,201,200,201,201,197,194,194,197,192,178,178,180,180,101,73,147,184,184,187,189,189,191,193,194,197,199,201,201,199,201,201,199,199,199,199,194,194,196,192,178,176,178,178,103,71,154,183,181,182,183,187,189,191,193,194,194,196,199,202,201,201,199,197,197,197,196,194,192,191,176,176,176,176,107,66,63,65,70,71,73,75,91,145,193,185,191,193,196,195,199,199,197,196,196,196,196,196,193,187,176,176,176,175,170,107,63,67,71,77,67,73,74,77,77,80,80,82,82,195,196,197,197,196,196,196,194,194,192,187,175,175,175,175,173,175,180,180,181,179,177,181,180,182,187,177,124,89,76,189,194,196,197,196,196,196,194,193,189,187,176,175,175,175,175,174,178,180,181,180,180,180,180,181,184,186,188,189,191,191,191,193,194,194,196,195,192,185,187,184,175,173,173,173,173,174,176,180,180,180,178,180,180,181,181,184,186,188,189,189,191,191,193,194,193,191,191,184,187,184,165,167,170,168,149,125,144,165,173,178,178,178,178,180,180,180,184,186,186,188,188,189,189,191,191,189,189,184,184,183,158,165,170,170,173,175,175,175,174,175,174,174,159,92,136,153,155,165,170,183,184,183,187,190,188,186,186,188,185,170], dtype=np.float32) / 255.0
ve2 = np.array([188,194,193,189,188,189,189,189,189,188,186,186,186,189,189,191,191,193,193,193,191,191,196,197,193,191,193,196,196,196,187,191,191,188,188,186,188,189,189,190,188,186,186,186,191,189,191,193,193,193,191,191,196,196,193,193,193,196,196,194,182,191,189,188,186,186,186,189,189,191,191,188,186,185,189,191,193,191,193,193,193,193,192,194,194,191,193,196,196,191,182,190,190,186,186,186,186,186,188,191,189,189,189,191,191,193,193,193,193,193,193,193,196,196,194,191,193,194,195,195,181,186,186,186,184,186,186,186,188,191,189,189,189,191,191,193,193,193,193,193,193,193,196,196,194,193,193,194,194,194,185,186,186,186,184,183,183,184,186,189,189,188,187,187,177,99,97,95,97,95,93,95,98,190,196,189,193,194,195,196,182,186,186,184,184,183,183,184,184,188,188,89,93,91,95,95,97,95,98,100,90,91,90,192,199,195,194,197,196,194,179,188,186,184,183,183,184,184,184,90,92,93,93,123,195,190,194,193,196,196,194,194,196,196,201,202,200,197,196,194,179,185,184,184,184,184,183,171,91,92,95,192,193,194,194,194,196,196,197,197,197,196,196,197,197,199,199,199,196,197,178,185,184,184,184,184,180,84,88,166,191,193,194,194,196,194,196,197,197,199,196,195,196,194,197,199,199,199,199,197,173,186,184,183,184,183,90,88,187,187,191,193,193,194,194,194,197,197,197,199,196,197,197,196,197,199,199,199,199,196,170,189,184,183,183,181,82,183,188,189,189,194,194,194,194,194,197,197,199,199,197,197,197,197,199,201,201,201,200,198,165,187,183,183,184,139,85,187,188,189,191,193,194,194,194,194,197,197,199,199,197,197,197,199,199,201,199,199,199,199,168,186,183,183,184,94,81,189,185,188,172,193,193,196,194,194,196,197,197,197,197,197,197,199,199,199,199,199,199,195,172,184,183,184,184,71,77,80,80,85,87,90,89,92,90,91,92,95,92,196,199,199,196,197,197,197,197,197,197,197,172,183,183,184,184,83,82,131,182,195,195,193,197,195,195,188,173,150,90,194,199,200,199,197,197,197,197,197,197,196,169,183,183,183,184,101,104,186,188,189,192,193,194,194,194,194,196,196,197,197,197,202,202,201,200,200,200,199,198,200,164,183,183,184,184,171,83,189,188,190,193,193,194,193,194,194,196,196,196,196,196,197,202,201,201,202,201,199,199,201,161,183,183,184,184,183,80,191,188,190,193,194,195,193,194,196,194,196,196,196,196,196,199,199,199,199,199,197,199,199,163,181,183,184,184,183,78,84,189,191,193,193,194,195,194,196,196,196,196,196,196,196,197,197,197,197,197,194,197,198,157,181,181,183,183,184,170,80,191,189,189,193,194,194,194,194,196,196,196,196,196,196,196,196,197,197,196,196,196,199,160,181,181,183,183,183,184,80,79,189,191,193,194,194,194,194,194,196,196,196,196,196,196,196,197,196,196,194,194,197,158,181,181,183,183,183,183,188,81,81,188,189,191,190,190,193,194,194,194,196,196,196,196,196,196,196,194,194,193,194,170,183,183,181,181,183,183,183,142,80,83,189,188,189,189,191,191,193,193,193,194,194,194,194,194,194,193,193,191,192,175,184,183,181,181,181,183,183,183,146,76,78,138,186,188,189,191,191,191,193,193,194,194,193,193,193,193,191,190,189,187,184,184,181,181,181,183,183,183,181,186,76,72,74,91,188,188,188,189,189,189,194,193,193,191,191,191,191,191,188,190,188,184,181,180,180,180,181,181,181,181,183,128,71,73,74,78,80,80,82,74,166,191,189,189,189,189,189,189,187,192,194,188,184,181,180,180,180,181,181,181,181,181,181,182,168,79,73,73,75,100,188,189,189,188,188,188,188,188,182,202,196,191,187,181,180,180,180,180,181,180,180,180,180,181,181,181,183,182,184,184,188,188,188,188,186,186,186,186,183,128,167,187,191,183,183,177,178,178,178,179,179,176,177,178,179,177,179,179,179,182,184,183,184,185,185,185,182,183,184], dtype=np.float32) / 255.0

vi1 = np.array([184,196,196,196,196,194,192,193,193,193,191,193,194,196,197,196,194,194,194,196,196,196,194,193,193,193,193,194,194,193,187,194,194,196,194,194,193,191,191,191,191,191,193,193,196,196,196,196,196,196,196,196,194,193,193,193,193,193,193,193,188,194,192,193,193,191,191,188,189,188,191,188,189,192,192,191,197,196,196,196,196,196,194,194,193,193,193,194,195,194,195,194,192,193,193,191,191,188,188,188,187,179,181,185,88,93,89,93,93,99,163,196,194,193,193,193,194,194,195,195,196,194,194,193,193,193,191,189,94,88,83,80,80,79,82,82,87,85,89,94,95,99,105,193,193,194,194,194,194,195,194,194,196,194,192,190,191,189,183,83,79,80,84,77,79,81,86,92,93,97,96,98,100,186,193,194,194,192,194,192,193,193,194,193,193,191,191,189,189,190,183,189,187,77,80,78,186,195,194,197,196,197,197,195,194,194,196,196,195,191,195,193,194,193,193,191,191,191,189,189,192,192,189,77,83,181,196,200,196,197,197,197,197,200,196,194,194,196,195,186,192,193,194,194,193,193,193,191,188,192,193,193,193,82,87,196,196,197,199,197,199,199,199,199,197,196,196,197,196,185,192,193,193,194,194,194,191,191,191,194,194,194,193,86,87,117,199,201,202,201,201,200,200,199,197,196,196,197,196,184,191,191,191,194,194,195,192,191,192,194,194,196,195,92,91,198,202,202,202,202,202,204,201,201,198,199,196,197,196,181,187,189,189,192,192,195,192,191,193,194,196,196,193,94,95,198,201,202,202,202,204,204,204,202,199,197,197,200,199,181,186,186,188,191,189,191,191,193,193,193,196,196,196,90,93,194,201,202,202,204,204,204,204,202,201,199,199,197,199,179,187,186,188,191,189,191,191,193,193,193,194,194,192,88,92,196,199,201,202,204,204,204,204,204,201,199,197,197,199,178,183,183,184,189,188,189,189,191,191,194,196,196,196,93,89,195,199,202,202,202,202,202,202,202,202,197,197,197,197,180,184,183,184,188,189,191,191,191,191,194,194,195,194,91,93,195,201,202,202,202,202,202,202,202,201,197,197,197,197,184,182,184,186,188,188,189,189,191,193,194,194,194,194,86,87,196,199,201,199,201,202,202,202,201,201,199,199,197,198,186,180,183,184,188,188,189,189,189,191,190,193,196,193,86,87,193,197,199,199,201,201,201,202,201,201,199,197,196,195,187,177,183,184,186,188,188,188,189,191,192,196,196,196,88,87,195,199,199,199,199,201,201,201,202,201,199,196,196,192,188,176,183,184,186,186,188,189,189,191,192,194,196,194,89,89,197,197,199,199,199,201,201,201,201,201,199,197,196,194,194,171,183,183,186,186,186,188,188,189,190,189,192,192,88,88,192,197,197,199,199,199,201,200,199,199,199,199,196,195,196,174,181,181,183,184,184,186,188,189,190,189,189,191,79,83,193,197,199,199,199,197,199,199,199,199,197,199,196,196,195,167,181,181,183,183,184,184,186,189,189,189,188,187,76,79,195,197,197,199,199,197,199,199,199,199,197,197,197,195,194,170,181,181,181,183,183,183,184,184,186,186,186,182,73,77,191,194,195,197,196,196,197,197,197,197,197,197,197,193,184,168,180,180,180,180,71,111,173,184,184,185,183,187,70,88,184,189,189,191,194,196,196,196,197,197,197,197,197,193,186,169,180,180,180,182,75,71,67,67,66,64,63,64,61,61,67,68,73,74,191,193,194,196,196,196,196,197,197,195,184,168,178,178,178,178,178,180,180,66,58,62,69,62,63,59,60,62,64,69,70,83,196,193,194,193,194,193,193,194,184,170,176,178,178,176,178,178,180,180,180,181,181,185,186,176,128,76,67,83,69,75,187,192,192,191,191,191,191,192,189,169,176,176,176,176,176,178,178,180,181,181,181,181,181,181,183,184,187,189,188,186,189,189,189,189,189,191,189,188,191,161,169,176,179,179,177,178,179,183,176,177,176,180,180,180,180,184,188,188,189,186,187,187,186,189,188,187,187,189,189], dtype=np.float32) / 255.0
vi2 = np.array([142,185,186,184,184,184,184,186,186,186,186,186,182,185,188,188,189,191,191,191,192,193,193,191,188,188,188,188,191,194,181,186,186,186,186,184,186,186,186,185,186,184,184,186,186,188,189,191,191,193,193,193,193,191,190,188,186,188,189,190,180,186,186,186,186,184,184,186,186,186,188,184,188,184,188,188,190,190,190,180,126,127,194,194,194,193,189,189,189,193,174,186,186,186,186,186,184,180,183,166,107,79,79,91,92,95,97,96,99,100,98,95,194,194,196,194,196,197,197,197,159,186,186,186,186,186,109,76,77,82,88,89,87,80,81,82,95,133,157,190,192,189,196,197,196,194,194,196,197,196,165,186,186,188,186,186,186,81,93,180,186,188,189,80,85,129,193,194,194,194,194,196,194,196,197,196,194,196,197,193,168,186,186,188,188,186,188,188,188,187,189,187,189,108,86,103,194,195,196,195,195,195,197,197,197,195,194,196,197,191,173,187,186,188,188,188,188,188,188,189,192,188,189,171,86,85,194,196,197,197,197,197,197,199,198,199,197,196,197,190,169,189,186,189,188,189,189,189,189,190,193,193,191,190,86,92,196,197,199,199,197,199,197,197,196,194,194,197,197,182,172,188,188,189,189,189,189,189,191,191,191,193,194,192,89,92,194,197,197,199,197,199,199,199,196,194,194,194,197,185,175,188,188,188,189,189,189,191,192,193,193,194,194,194,89,90,196,197,197,199,200,199,199,200,198,196,196,196,196,184,177,186,186,189,189,189,189,191,193,193,193,194,194,194,92,94,196,197,199,199,201,201,201,199,199,196,194,194,194,169,178,184,186,189,189,189,191,191,193,193,194,194,194,196,87,92,197,199,200,201,201,202,201,201,199,197,194,194,194,170,180,184,186,186,191,189,191,193,193,193,194,194,196,196,90,92,199,201,201,202,201,202,201,201,199,197,197,194,192,166,180,183,184,186,188,189,189,191,193,194,194,194,194,196,92,95,197,197,200,201,201,202,199,199,199,197,197,196,194,175,180,183,184,186,188,189,189,191,193,194,194,196,196,196,93,87,197,197,199,201,202,202,202,197,197,197,197,196,194,188,184,183,183,184,189,189,189,191,191,193,196,196,196,196,96,95,192,197,197,199,202,201,202,203,199,197,197,196,199,177,180,181,183,186,188,189,189,191,193,193,194,196,196,196,87,90,196,197,199,199,201,201,201,201,198,196,199,195,196,177,183,184,184,186,186,188,189,191,193,193,194,196,196,196,86,88,196,199,199,199,199,201,201,201,199,196,196,196,195,173,182,184,184,188,188,188,189,191,193,194,194,196,194,194,92,89,197,197,197,199,199,199,201,199,199,195,194,194,194,178,181,183,183,184,186,186,188,189,191,192,193,193,193,193,82,84,193,193,196,196,196,196,197,199,197,197,196,193,194,183,180,181,183,184,184,186,186,188,189,190,191,191,192,193,79,79,193,194,196,196,197,200,197,197,197,196,194,194,192,193,180,181,181,183,183,184,186,186,185,190,189,189,189,189,77,79,191,194,194,196,197,197,197,197,197,196,194,194,192,193,183,180,181,181,181,181,181,183,185,185,187,187,188,187,72,67,189,191,192,193,196,196,192,197,195,193,193,194,192,194,180,180,180,180,175,129,69,74,71,74,74,78,77,79,64,66,84,88,83,83,87,92,81,83,193,193,193,193,192,192,179,180,180,178,170,67,69,73,72,74,75,74,76,76,76,75,76,78,79,81,81,82,81,77,193,191,191,191,190,190,177,178,180,178,176,181,178,180,181,181,181,181,182,184,183,183,184,186,186,188,189,191,191,191,189,188,188,188,187,186,176,176,178,176,176,176,178,178,180,180,181,180,180,181,181,181,183,184,186,186,188,189,189,189,189,186,187,188,187,184,175,175,175,175,175,175,176,176,178,179,180,180,180,178,180,180,179,182,184,184,186,186,188,188,188,186,186,186,185,185,139,151,147,156,153,155,160,165,168,168,170,167,169,174,178,173,172,176,181,179,181,184,184,187,181,183,181,185,184,181], dtype=np.float32) / 255.0

vo1 = np.array([146,169,170,177,180,183,183,184,183,185,186,186,188,188,191,189,191,191,191,191,193,193,195,194,194,194,194,194,193,189,168,183,183,183,184,184,184,184,184,184,186,186,186,188,189,189,191,191,189,189,191,193,193,193,194,194,194,193,189,180,163,182,183,183,183,183,184,184,186,184,186,186,186,186,188,188,191,191,191,189,193,193,193,194,194,193,194,193,192,178,162,182,183,183,183,183,183,184,184,184,184,184,186,186,186,186,189,189,191,191,191,193,194,194,194,194,194,193,192,173,156,182,183,183,181,181,183,184,184,185,185,157,102,88,94,86,92,128,189,191,191,193,194,194,193,194,194,194,186,170,156,182,183,179,181,181,181,180,99,88,87,89,89,88,109,125,103,93,92,97,114,187,193,194,194,194,193,193,193,173,157,182,183,183,180,180,180,93,82,84,180,187,187,186,188,187,189,191,191,195,97,90,194,194,194,194,194,193,192,178,155,181,181,181,180,180,150,81,82,183,188,189,188,188,188,188,191,191,193,191,191,120,92,190,194,194,194,194,192,183,167,180,181,181,180,179,84,79,184,185,189,188,191,191,189,188,191,191,193,193,193,191,90,93,197,194,194,194,189,189,169,179,180,181,179,78,83,169,184,187,189,191,191,191,191,191,193,194,194,194,194,194,197,91,88,194,194,194,190,190,169,183,181,180,180,82,84,184,187,189,191,191,191,193,193,194,193,194,196,196,196,194,198,130,90,188,194,193,193,196,174,184,181,183,119,79,140,185,186,188,191,193,193,194,194,194,194,196,196,196,196,196,196,192,90,96,194,194,194,193,176,187,183,183,78,82,186,184,187,188,193,193,194,194,194,194,196,196,196,196,196,196,196,195,90,92,191,196,196,196,176,185,183,182,79,80,186,184,186,188,191,192,194,194,194,194,196,196,197,197,197,196,194,195,95,92,191,194,195,195,180,185,184,189,79,84,184,184,186,186,191,191,194,194,194,194,194,196,196,196,196,196,196,193,93,95,198,194,195,193,177,186,184,182,83,85,184,186,186,189,191,191,192,194,194,194,194,195,196,196,196,196,194,196,94,92,193,194,195,195,177,184,183,185,79,81,186,186,188,188,191,191,192,194,194,194,196,197,197,197,197,196,194,197,86,92,194,194,195,195,178,182,183,186,76,82,184,180,188,189,191,191,193,193,194,194,194,194,196,196,196,196,194,196,84,86,189,193,193,196,176,178,181,179,77,78,183,186,187,189,191,191,191,193,193,193,193,194,194,196,196,196,189,81,84,163,191,193,193,195,176,180,180,178,89,70,186,184,186,188,189,191,191,193,191,193,193,193,193,194,194,192,188,76,78,188,191,190,190,191,175,178,181,180,181,64,67,183,183,185,189,188,189,191,191,193,191,191,191,191,191,191,75,76,81,191,189,189,191,191,174,178,180,180,178,62,64,69,182,185,188,188,189,189,189,191,191,191,191,191,188,78,76,76,187,189,189,189,189,191,174,177,178,180,180,179,64,64,70,184,186,188,188,188,189,189,189,191,189,163,76,69,72,187,189,189,188,189,188,191,173,173,175,178,177,177,114,60,64,67,66,186,184,182,187,189,188,116,74,70,70,68,188,189,189,188,188,188,188,189,171,177,181,181,181,182,184,136,60,63,58,65,61,63,58,63,66,64,66,68,71,184,186,188,186,186,186,186,186,186,171,179,180,180,181,181,181,183,181,63,61,61,58,57,59,58,64,70,148,188,184,186,187,184,189,187,186,186,187,186,170,178,180,178,178,178,180,181,181,181,187,77,70,59,82,184,181,182,183,184,184,184,183,184,184,186,186,183,183,189,168,182,180,180,178,178,180,180,180,180,181,180,180,180,180,180,181,183,186,184,184,184,184,180,181,180,182,181,182,182,166,180,181,180,178,178,178,180,180,180,180,180,180,180,180,180,181,182,186,187,187,186,183,180,180,180,180,180,181,178,162,192,181,181,183,179,176,178,178,178,175,177,178,177,176,174,172,176,182,186,183,178,185,178,175,181,175,177,170,175], dtype=np.float32) / 255.0
vo2 = np.array([148,191,194,195,191,186,186,186,183,183,183,186,186,190,189,191,191,194,193,193,193,194,193,194,194,193,193,193,193,193,186,189,190,193,192,190,186,183,184,183,184,184,186,188,186,189,190,193,194,193,193,193,193,193,193,193,193,193,193,194,184,191,188,189,191,189,186,186,183,184,184,179,180,92,93,92,93,95,97,103,185,192,193,193,193,193,193,193,193,191,184,189,188,188,189,189,188,188,186,185,186,90,90,93,101,186,189,189,189,160,93,94,115,191,193,193,193,193,192,193,184,189,188,188,188,188,188,188,188,183,90,89,144,186,188,188,193,193,194,195,195,191,94,102,188,191,191,191,192,191,184,189,186,186,186,186,188,188,187,89,90,167,189,189,189,191,193,194,194,194,196,196,191,95,99,189,193,191,190,191,183,187,186,186,186,186,188,186,84,90,143,191,193,193,194,194,194,195,196,196,196,196,198,122,95,179,194,192,191,191,185,188,186,186,186,188,188,190,89,93,189,194,194,194,194,194,196,196,196,197,197,197,196,190,95,98,194,194,194,189,181,187,186,188,186,188,189,89,89,190,191,194,196,196,196,196,197,197,197,197,197,199,197,198,98,94,194,194,194,188,185,186,184,186,186,186,184,90,93,192,194,196,196,197,197,197,199,199,199,199,199,199,199,197,93,95,194,196,194,185,183,185,184,184,186,186,86,92,189,189,194,196,196,197,199,200,199,199,199,201,199,199,199,199,94,95,193,196,195,189,184,189,188,186,186,187,85,87,190,192,194,195,197,198,199,199,201,201,201,201,201,201,199,199,94,96,194,197,196,194,184,188,188,189,187,187,82,113,189,192,194,196,197,197,199,199,201,201,201,201,201,201,199,197,99,95,198,197,196,194,185,191,189,189,189,128,84,193,189,192,194,196,197,197,197,199,201,201,201,201,201,201,199,200,95,97,200,199,197,193,186,189,189,189,189,106,87,188,189,192,194,196,197,197,199,199,201,201,201,201,201,199,200,127,92,157,199,199,199,194,181,187,189,189,189,87,85,189,191,191,194,196,196,197,197,199,199,199,201,199,201,199,198,95,93,196,199,199,198,195,179,188,186,189,189,86,83,185,189,191,194,194,196,197,197,199,199,199,199,199,199,199,113,92,112,199,201,199,199,197,180,186,184,186,186,118,82,191,189,192,194,196,196,197,197,197,199,199,197,197,197,203,92,91,197,199,199,199,197,195,181,183,184,184,186,188,81,127,191,193,194,193,196,197,197,197,197,197,197,197,201,94,93,203,197,199,199,199,196,193,181,181,186,186,186,186,79,83,191,192,194,193,196,196,197,197,197,197,197,105,94,92,200,197,197,199,199,197,196,193,181,184,184,186,186,188,154,76,139,190,194,193,194,194,194,195,186,106,87,87,84,197,197,197,197,197,197,197,195,191,177,181,183,184,186,186,186,102,77,134,188,190,193,188,113,86,85,88,87,195,196,196,197,197,197,197,196,196,196,196,177,184,183,184,184,184,186,184,188,81,77,75,74,76,79,83,187,193,196,196,196,196,196,196,196,196,196,196,195,194,177,179,181,183,183,183,184,184,184,186,188,188,171,191,189,191,193,193,193,196,196,196,194,196,196,194,194,194,194,194,175,180,181,181,183,183,183,183,184,185,186,186,187,189,189,188,191,191,193,193,194,194,194,194,194,194,194,193,193,194,177,179,181,181,181,181,183,183,183,184,184,186,186,188,188,188,189,191,191,191,193,193,194,194,193,193,193,193,193,193,174,179,180,180,180,180,180,181,181,183,183,183,184,184,186,188,189,191,190,189,191,191,193,191,191,191,191,191,191,191,171,179,178,180,178,178,180,180,181,181,183,183,183,184,184,186,188,189,189,189,189,189,191,189,189,189,189,189,189,189,165,177,178,178,178,176,178,178,180,180,180,181,181,183,183,184,186,187,193,189,186,188,186,188,188,186,188,188,187,186,167,160,171,171,173,175,173,175,175,176,178,176,176,176,179,178,180,179,176,181,180,182,178,180,171,151,138,130,112,125], dtype=np.float32) / 255.0

vu1 = np.array([169,184,186,188,188,188,191,193,193,191,192,192,185,186,185,184,189,194,194,194,199,199,203,200,196,199,201,202,198,196,184,181,183,186,186,188,189,189,191,191,193,192,188,189,191,191,194,194,194,194,194,196,199,199,197,199,199,196,199,199,183,184,184,184,184,186,188,186,188,188,188,192,189,188,190,189,191,193,193,193,193,193,196,196,196,197,197,197,199,201,185,184,183,183,186,184,184,186,186,191,193,191,189,189,191,191,191,193,193,193,193,191,185,190,194,194,194,196,197,199,183,187,184,184,186,185,184,184,184,86,86,191,192,188,189,191,194,193,193,193,193,190,88,89,193,193,193,194,195,198,183,184,184,183,184,186,186,183,105,84,136,188,191,188,189,191,193,193,193,193,191,188,112,90,109,188,189,189,192,195,183,184,184,184,184,186,186,187,84,91,188,189,191,193,189,189,192,193,191,192,191,191,186,92,92,188,189,189,189,188,183,187,184,184,184,186,186,101,89,153,192,191,191,193,193,190,193,193,193,193,194,193,187,92,87,185,190,189,189,193,178,185,186,184,184,185,184,84,87,185,191,194,194,194,194,196,194,194,194,194,196,193,193,100,93,185,191,189,191,192,179,185,186,186,184,184,176,87,106,189,191,194,194,194,194,196,197,197,197,197,197,194,194,162,93,153,193,192,191,194,179,185,186,187,186,187,101,91,178,192,191,194,196,194,196,196,197,197,199,197,197,196,194,194,93,107,193,193,191,192,177,184,186,188,188,186,84,88,190,190,194,196,196,196,197,197,199,197,199,199,199,197,196,191,92,90,193,193,193,193,178,184,186,186,186,186,85,88,187,193,194,196,196,197,197,197,199,199,199,199,199,199,196,194,93,94,194,194,193,192,176,182,184,184,185,187,85,89,191,191,193,196,196,197,197,197,199,199,199,199,199,199,197,192,93,93,194,194,194,193,176,180,184,184,184,185,84,84,189,191,194,194,196,196,197,197,199,199,199,199,199,197,197,196,96,92,195,196,194,195,174,181,186,186,184,183,84,82,190,192,194,194,196,196,197,197,199,197,199,199,199,199,197,197,92,92,195,196,195,197,172,181,184,186,186,185,81,82,191,191,194,194,196,196,197,197,197,197,197,199,197,199,197,195,94,93,195,196,197,198,166,179,184,186,186,188,81,83,191,192,194,196,196,197,197,199,199,197,197,197,199,199,197,194,92,92,196,196,197,200,156,178,186,186,186,187,83,83,188,192,194,196,197,197,197,197,197,197,197,197,197,199,197,154,89,159,196,194,197,199,152,180,184,186,186,186,82,77,187,190,193,194,195,197,197,199,199,197,197,197,197,199,195,85,90,198,196,194,194,196,137,180,183,183,184,184,152,78,82,188,191,193,194,196,197,197,199,199,197,197,197,197,194,90,91,192,194,194,194,194,149,180,180,183,183,183,182,74,75,183,189,193,194,194,196,197,197,199,199,197,197,197,207,88,90,196,194,194,193,192,144,180,180,183,183,183,183,188,74,78,186,187,190,193,193,196,197,197,197,197,197,196,87,89,196,196,194,194,193,194,150,178,180,181,181,181,183,183,123,75,77,180,188,189,189,191,194,196,196,196,194,93,84,123,194,194,194,194,193,193,151,178,178,180,181,181,181,183,183,85,76,82,187,187,188,189,192,192,194,194,82,83,105,194,194,194,194,193,192,192,163,178,178,180,180,181,181,181,181,180,108,76,74,74,168,190,185,172,82,87,83,146,193,194,193,193,193,193,191,189,158,178,178,178,178,178,178,180,180,181,181,181,166,70,75,80,72,76,146,190,189,191,193,193,193,192,193,191,189,189,154,176,176,178,178,178,178,180,180,180,180,181,181,181,181,181,183,186,186,188,189,189,191,191,191,189,191,188,188,184,149,176,176,176,176,176,176,178,178,178,178,180,180,180,180,180,183,184,184,186,186,188,188,189,188,189,189,189,188,185,132,175,174,175,175,175,175,175,176,176,177,178,176,175,173,175,178,180,181,183,181,186,185,188,188,190,188,188,187,179], dtype=np.float32) / 255.0
vu2 = np.array([192,194,191,186,178,173,171,170,166,166,166,170,171,175,171,174,172,172,172,175,184,184,181,186,191,194,195,196,181,160,189,189,189,189,189,189,189,189,189,189,189,188,188,193,193,193,193,193,191,192,191,189,189,191,200,204,204,203,202,180,188,188,188,188,189,188,188,189,189,189,189,189,188,193,193,193,193,193,193,193,191,189,189,189,192,202,202,204,202,193,187,188,188,187,188,188,188,188,189,189,190,192,192,193,193,193,193,193,193,193,191,189,189,188,188,193,202,203,205,198,186,186,186,186,186,187,186,181,186,192,191,193,193,194,194,194,196,193,193,194,193,191,191,189,186,186,194,201,204,201,187,186,186,186,186,186,185,86,86,187,189,193,193,194,194,196,196,196,194,194,193,191,191,131,98,184,188,198,202,200,184,186,186,185,186,185,152,83,86,185,188,191,193,194,196,196,196,196,196,194,193,193,188,95,94,186,186,192,201,201,184,184,184,184,184,182,80,86,118,188,188,188,193,194,194,196,197,197,197,197,194,194,191,97,94,188,188,191,195,196,186,184,184,184,184,183,85,86,185,189,189,191,193,194,196,196,197,199,199,197,195,194,190,107,96,180,189,188,194,199,184,184,184,183,184,180,83,86,183,187,190,191,193,194,196,197,197,199,199,199,196,196,192,117,95,171,190,190,193,201,184,183,183,184,184,185,84,87,189,187,191,191,193,194,196,197,197,200,199,199,197,196,193,110,93,177,191,191,193,204,183,183,183,183,184,178,87,87,189,191,190,193,193,194,196,197,197,199,202,201,198,197,193,94,95,189,189,191,193,205,181,181,183,182,184,161,85,83,189,191,192,194,194,193,196,196,197,199,201,201,199,197,195,106,94,191,191,191,193,207,181,181,181,182,184,146,83,88,190,191,192,193,194,196,196,197,197,199,201,201,199,199,196,98,93,191,191,191,193,209,183,183,182,181,184,167,83,86,190,191,192,194,196,196,197,197,197,199,201,201,199,199,198,99,95,193,194,192,193,208,186,183,184,183,184,182,83,82,189,191,193,194,196,196,197,197,197,197,199,199,199,197,145,95,134,194,194,194,196,205,186,184,184,184,186,189,85,91,190,193,193,196,196,196,197,197,197,197,197,197,199,197,94,92,193,194,194,193,194,203,186,184,186,184,186,187,80,84,188,194,193,196,196,197,197,199,199,198,197,197,197,197,89,92,191,194,193,193,194,200,184,184,186,186,188,185,82,84,190,191,193,196,196,197,197,197,197,199,197,199,197,176,91,101,192,194,193,191,193,200,184,184,186,186,186,187,78,83,185,191,194,196,196,197,199,199,197,198,197,197,196,94,90,196,191,194,192,189,191,199,184,183,184,185,187,186,150,80,84,192,193,196,196,196,197,197,197,197,197,196,201,93,94,193,195,194,193,189,191,199,183,183,183,184,184,186,187,77,80,185,193,194,196,196,197,197,197,197,196,196,92,89,196,194,196,194,193,190,191,196,181,183,183,184,184,186,186,77,77,111,190,193,194,194,196,196,196,197,196,177,90,85,199,194,196,194,193,191,191,194,180,181,181,182,183,184,184,184,73,74,189,188,191,193,194,194,196,196,193,92,89,190,196,194,194,193,193,191,191,191,180,181,181,182,183,184,184,184,171,72,79,187,189,190,191,193,192,84,90,94,198,196,194,196,194,194,192,189,190,191,178,180,180,181,183,184,183,184,184,165,77,75,78,75,80,78,86,84,171,193,196,196,196,194,194,194,191,189,190,189,176,178,178,180,181,181,183,181,183,183,182,181,190,184,185,186,188,190,193,193,194,194,194,194,193,191,191,188,188,189,175,176,178,179,180,180,181,181,181,183,182,183,183,183,185,186,188,188,191,191,193,193,193,193,192,189,190,188,186,187,175,175,176,177,178,180,180,180,181,181,180,181,181,181,183,184,183,186,189,189,191,193,193,189,191,189,188,186,186,185,173,174,171,171,172,174,173,175,179,179,178,176,178,175,176,180,181,184,185,186,187,187,189,187,188,188,185,185,184,183], dtype=np.float32) / 255.0

vm1 = np.array([181,174,180,156,183,184,186,186,186,186,186,188,186,186,188,189,189,189,189,190,191,192,193,193,193,192,192,190,189,187,166,177,182,165,184,184,186,186,186,186,185,188,188,188,189,189,189,189,185,191,191,191,191,191,191,191,191,193,193,189,181,183,183,174,184,184,187,184,186,186,186,186,188,188,188,188,189,118,131,189,191,193,193,193,193,193,193,193,191,191,180,183,183,174,184,184,92,132,186,186,186,186,188,188,189,189,189,189,189,190,191,193,193,193,193,193,191,191,193,191,181,183,183,178,184,185,187,182,184,186,186,186,188,188,189,190,190,190,190,191,193,193,193,193,193,180,99,96,193,191,181,183,183,186,184,184,184,184,184,184,184,184,84,190,189,191,191,191,191,191,193,193,193,193,193,193,97,93,193,191,181,181,183,187,186,184,184,184,184,184,185,88,109,191,190,191,191,193,193,191,193,193,193,193,193,193,193,194,193,191,180,181,181,189,186,184,184,184,186,186,95,132,188,189,192,193,193,193,193,193,197,99,189,194,194,193,193,193,193,193,180,181,181,185,186,186,186,184,186,186,187,188,188,191,192,193,194,193,193,193,193,98,194,194,194,194,193,194,193,193,180,181,181,186,186,186,186,186,186,188,188,188,188,189,191,193,194,194,194,194,192,101,190,194,194,194,194,194,194,194,180,180,181,185,186,187,188,186,188,188,189,189,189,179,192,193,193,194,194,196,196,196,196,196,196,194,196,189,194,194,181,181,181,185,184,186,186,188,188,188,189,189,191,92,193,194,196,197,196,196,196,196,196,196,197,195,98,103,196,194,181,181,181,190,186,186,185,124,119,189,190,193,193,92,194,194,196,196,196,197,197,197,197,197,197,197,101,196,196,194,181,181,183,189,186,186,91,87,88,189,191,193,193,193,194,194,196,194,189,198,197,197,197,197,197,196,196,196,196,194,181,181,184,193,186,185,100,184,189,188,191,193,193,194,194,191,97,96,100,197,197,197,201,102,202,196,196,196,196,194,180,181,182,186,186,186,188,188,189,191,191,193,193,194,194,193,135,87,188,196,197,197,197,194,99,196,196,196,196,196,180,181,184,186,186,186,188,188,191,191,191,193,193,194,194,144,92,191,196,196,197,197,197,197,88,196,196,196,196,194,180,181,180,186,186,186,188,188,189,190,191,193,100,88,194,195,194,196,196,196,197,197,197,197,197,196,196,196,196,194,178,180,173,184,186,186,186,188,189,191,191,191,89,193,194,194,194,194,196,196,196,196,196,196,196,197,196,196,196,194,178,180,174,182,184,186,186,188,189,191,191,193,193,193,194,194,194,194,194,196,196,196,196,196,196,196,197,196,194,194,176,178,177,185,184,184,186,186,188,185,191,191,193,193,193,193,194,194,194,193,202,89,194,194,194,194,194,194,194,194,176,176,176,183,183,184,186,186,89,82,189,191,191,193,193,194,190,194,194,190,91,151,194,194,194,194,194,194,194,193,175,176,176,182,183,183,184,78,87,186,189,191,191,191,191,193,86,193,193,192,192,193,193,193,192,88,193,193,193,189,175,175,171,181,181,183,184,82,183,186,187,189,191,191,192,193,86,191,193,193,193,193,192,196,90,186,191,191,189,191,175,175,172,181,181,183,183,184,184,186,186,189,191,191,193,184,80,191,193,193,193,193,191,81,194,189,189,189,189,189,171,173,165,178,178,180,181,183,183,184,184,188,188,190,191,189,188,190,191,191,191,190,189,187,187,189,188,188,188,186,171,171,164,178,178,178,180,180,181,183,184,184,186,188,189,191,188,188,189,189,189,188,188,188,186,188,186,186,186,186,167,168,157,175,176,175,178,180,180,180,180,183,184,189,188,186,186,188,188,188,188,188,186,186,186,186,186,186,184,186,161,165,154,178,174,174,175,178,177,174,175,181,184,186,185,180,184,185,187,186,184,184,183,184,182,183,183,181,182,182,163,165,167,170,171,173,173,173,173,175,174,174,174,174,176,176,178,179,182,182,181,186,188,192,173,126,107,112,134,129], dtype=np.float32) / 255.0
vm2 = np.array([186,184,182,184,185,187,190,188,185,177,175,174,175,176,181,185,186,189,193,194,193,196,195,197,196,196,193,196,182,190,179,188,188,189,189,188,188,188,188,188,189,189,191,191,191,193,193,194,196,196,194,194,196,196,196,195,194,194,197,194,177,188,188,188,188,188,188,188,188,188,188,188,188,192,101,93,166,194,194,196,194,194,196,196,194,194,194,194,196,196,174,189,188,188,188,188,188,186,188,188,188,188,169,92,94,91,193,193,194,194,194,194,196,196,196,194,194,194,199,194,172,188,188,188,187,187,187,186,186,189,183,90,94,92,181,190,191,193,194,194,193,190,195,196,196,195,195,194,197,194,168,188,188,186,186,181,184,188,185,97,89,86,123,189,190,193,193,193,194,193,100,100,195,196,196,196,196,194,197,194,167,188,186,186,185,78,75,72,88,87,93,189,188,189,191,193,194,194,194,101,99,130,194,196,196,197,197,197,197,196,167,186,186,184,182,176,75,73,74,76,187,190,189,191,192,193,193,193,95,97,172,196,196,197,196,199,199,197,198,197,166,186,186,177,88,87,92,169,77,77,79,78,186,191,191,190,155,98,97,200,196,197,197,197,195,199,197,197,198,198,164,184,92,93,90,125,185,186,187,189,80,80,82,189,190,94,93,98,198,201,197,197,197,197,197,199,199,199,197,198,168,86,85,96,186,185,188,188,187,188,189,171,78,80,84,91,89,196,197,198,199,197,199,199,197,94,96,199,199,196,170,187,136,186,184,188,189,188,188,191,191,191,120,79,81,75,194,196,197,198,199,199,199,199,102,99,99,197,202,197,174,188,186,186,186,187,189,189,190,198,193,90,91,95,86,85,83,191,197,198,199,199,207,99,98,92,197,199,199,199,175,189,188,186,188,188,189,189,191,105,92,97,157,198,201,88,86,200,197,197,199,194,102,98,112,199,199,199,200,198,178,189,188,186,186,188,189,188,90,95,110,191,197,196,196,201,89,92,200,198,199,91,94,175,202,199,196,199,199,199,171,192,186,186,186,189,87,92,98,180,196,196,197,197,197,197,115,87,83,144,93,88,199,196,197,197,197,197,199,198,169,192,186,188,184,89,90,98,188,193,194,196,197,197,197,197,198,87,79,87,89,193,196,197,197,197,197,197,197,198,169,189,187,129,87,87,187,185,190,194,194,196,196,197,197,197,196,84,78,77,194,197,197,197,196,92,189,196,197,201,174,188,187,186,86,188,189,189,189,193,194,194,196,196,196,133,88,90,93,84,69,196,196,196,76,82,81,197,194,198,179,188,188,186,186,189,189,191,191,193,194,194,196,196,93,93,92,195,196,82,86,186,196,91,83,80,196,193,194,196,179,186,186,186,188,188,189,189,191,193,193,195,193,89,95,131,196,196,196,195,85,83,74,82,85,196,197,196,196,196,180,186,186,186,186,188,189,189,191,193,186,85,88,93,193,196,196,196,196,196,168,73,73,78,188,197,197,196,196,196,178,185,186,184,186,186,188,189,189,190,85,90,85,194,195,194,194,196,196,192,84,74,79,196,196,197,196,196,196,198,178,182,184,184,184,186,186,186,144,83,85,165,191,193,194,194,194,195,104,82,77,200,84,85,195,196,196,196,196,192,178,181,183,183,184,184,187,77,82,86,194,191,191,191,193,193,191,86,85,83,194,194,89,83,199,196,196,196,196,192,177,179,181,181,183,184,72,80,88,185,188,188,189,190,192,197,79,82,77,192,194,194,201,79,194,196,195,195,196,188,176,179,180,181,181,183,183,192,184,186,186,188,188,189,71,76,80,168,191,193,193,194,194,194,194,194,194,194,196,196,173,177,180,180,181,181,181,183,183,184,184,186,188,188,77,71,187,189,191,192,191,193,194,194,194,194,194,194,194,197,167,177,178,178,180,180,180,180,181,181,183,183,183,184,186,187,186,188,189,189,191,191,190,193,192,192,190,191,190,198,167,176,178,177,178,179,179,180,180,171,165,160,153,151,147,153,162,169,174,183,187,189,191,193,195,188,195,193,190,180], dtype=np.float32) / 255.0
vm3 = np.array([175,177,175,175,176,178,178,180,180,178,178,178,180,180,181,180,180,180,180,180,181,181,181,179,176,173,173,169,169,163,176,177,178,178,178,180,180,183,180,181,181,181,181,183,183,183,181,180,181,180,184,183,183,181,180,177,177,175,172,171,176,177,180,180,180,180,180,184,183,183,181,181,183,183,184,183,183,183,181,183,185,186,186,185,185,183,181,178,177,176,178,176,180,180,180,181,180,184,183,183,183,181,186,186,184,184,186,186,186,184,184,188,188,189,188,186,186,183,181,179,179,179,181,181,181,183,183,183,184,184,183,183,188,186,188,189,187,188,187,187,189,189,189,191,188,189,187,186,185,182,178,179,181,181,183,183,183,184,186,184,184,185,185,186,188,191,192,192,190,191,191,191,192,191,191,192,190,190,188,188,178,180,181,181,183,183,184,185,187,188,188,188,189,188,189,191,192,192,193,193,193,194,194,194,194,193,194,193,191,191,178,180,183,183,183,184,184,186,188,189,191,191,191,191,192,194,195,195,194,195,195,195,196,196,195,195,195,196,195,195,180,180,183,183,183,184,186,188,189,189,192,193,193,195,195,197,197,197,198,198,197,197,197,196,197,198,197,197,198,197,181,181,184,184,186,184,186,189,191,191,194,194,194,196,196,199,199,201,199,199,199,202,197,199,197,199,199,200,201,202,181,182,184,184,186,188,189,191,193,194,195,197,197,199,201,200,200,202,202,204,202,201,201,199,199,201,200,201,202,202,183,183,186,186,186,188,189,191,194,197,197,200,199,201,202,202,205,204,204,205,204,204,202,201,201,201,201,202,204,204,184,184,186,188,189,189,191,193,196,197,199,201,202,204,204,206,206,207,207,206,206,204,204,204,203,203,202,202,202,206,184,184,186,188,189,191,193,194,197,199,201,202,202,205,206,206,207,209,207,207,207,206,206,206,206,206,204,202,204,206,184,185,186,188,191,191,193,194,197,201,200,202,204,206,206,207,209,210,209,210,209,207,207,207,207,206,204,203,204,204,181,186,188,188,191,193,194,196,199,201,202,204,206,209,207,206,209,210,210,210,210,210,210,209,210,208,206,205,204,201,181,186,188,188,191,193,194,196,201,199,204,206,206,209,209,207,209,210,210,210,210,210,210,210,212,213,211,208,204,201,183,184,186,189,191,193,196,197,201,201,204,204,206,207,209,209,209,210,210,211,210,209,210,210,214,214,214,212,207,202,181,184,188,188,191,194,196,197,201,202,202,206,206,207,207,209,209,210,210,210,210,209,209,210,212,214,214,212,210,205,181,184,188,188,191,194,197,197,201,202,204,206,206,206,207,209,209,209,210,210,209,207,207,208,210,210,211,212,212,206,179,181,186,188,189,193,195,197,199,201,202,204,204,206,206,207,207,209,209,209,205,206,206,207,207,209,209,209,210,206,178,181,183,186,189,191,195,196,199,201,202,202,204,206,206,206,207,209,209,207,207,204,206,205,207,207,207,208,209,204,176,180,181,186,188,190,194,194,199,201,201,202,202,204,205,206,207,207,207,207,207,204,204,206,206,207,206,206,207,200,173,178,180,183,186,188,192,193,198,197,197,200,201,201,202,206,206,207,206,206,206,204,204,206,206,206,204,203,203,195,173,174,178,181,184,186,189,193,196,196,198,195,197,199,202,204,206,206,206,206,206,204,204,206,206,206,204,203,200,192,169,172,175,180,182,186,189,190,194,194,194,193,195,197,200,202,202,203,203,203,203,204,204,206,204,205,204,201,199,192,165,170,173,175,179,181,184,186,190,189,189,189,192,193,195,198,200,202,202,201,201,202,204,204,202,202,202,202,197,192,163,167,169,174,178,180,183,184,185,187,187,187,187,190,191,193,195,195,197,198,198,201,202,202,201,201,201,200,199,190,160,164,168,170,174,178,180,181,183,183,183,183,181,183,185,188,189,191,193,194,196,197,201,201,201,197,197,197,194,187,160,159,163,169,173,177,178,180,180,178,176,176,173,177,179,180,180,183,187,189,193,196,196,197,197,196,196,196,193,187], dtype=np.float32) / 255.0

# Hacer predicciones sobre v1, v2, v3, v4
prediccion_va1 = model.predict(np.expand_dims(va1, axis=0))
prediccion_va2 = model.predict(np.expand_dims(va2, axis=0))
prediccion_ve1 = model.predict(np.expand_dims(ve1, axis=0))
prediccion_ve2 = model.predict(np.expand_dims(ve2, axis=0))
prediccion_vi1 = model.predict(np.expand_dims(vi1, axis=0))
prediccion_vi2 = model.predict(np.expand_dims(vi2, axis=0))
prediccion_vo1 = model.predict(np.expand_dims(vo1, axis=0))
prediccion_vo2 = model.predict(np.expand_dims(vo2, axis=0))
prediccion_vu1 = model.predict(np.expand_dims(vu1, axis=0))
prediccion_vu2 = model.predict(np.expand_dims(vu2, axis=0))
prediccion_vm1 = model.predict(np.expand_dims(vm1, axis=0))
prediccion_vm2 = model.predict(np.expand_dims(vm2, axis=0))
prediccion_vm3 = model.predict(np.expand_dims(vm3, axis=0))

# Imprimir resultados de la predicción
print("Resultados de la predicción:")
print(f"Vector va1, Predicción: {np.argmax(prediccion_va1 )}")
print(f"Vector va2, Predicción: {np.argmax(prediccion_va1 )}")
print(f"Vector ve1, Predicción: {np.argmax(prediccion_ve1 )}")
print(f"Vector ve2, Predicción: {np.argmax(prediccion_ve2 )}")
print(f"Vector vi1, Predicción: {np.argmax(prediccion_vi1 )}")
print(f"Vector vi2, Predicción: {np.argmax(prediccion_vi2 )}")
print(f"Vector vo1, Predicción: {np.argmax(prediccion_vo1 )}")
print(f"Vector vo2, Predicción: {np.argmax(prediccion_vo2 )}")
print(f"Vector vu1, Predicción: {np.argmax(prediccion_vu1 )}")
print(f"Vector vu2, Predicción: {np.argmax(prediccion_vu2 )}")
print(f"Vector vm1, Predicción: {np.argmax(prediccion_vm1 )}")
print(f"Vector vm2, Predicción: {np.argmax(prediccion_vm2 )}")
print(f"Vector No Data, Predicción: {np.argmax(prediccion_vm3 )}")


plt.show()

# Guardar el modelo en dos partes separadas: JSON y pesos en HDF5
# Serializar el modelo a JSON
model_json = model.to_json()
with open("modelo.json", "w") as json_file:
    json_file.write(model_json)

# Serializar los pesos a HDF5
model.save_weights("modelo_pesos.weights.h5")
print("Modelo Guardado!")
